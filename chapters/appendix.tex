\begin{refsection} 

\chapter{Computational Details} \label{appendix:sec-computational} 
 
All calculations in this thesis were performed in the \dft{DFT}{} framework, 
as implemented in the \dft{VASP}{}, save for the calculation of the energy 
landscapes presented in Section~\ref{batteries:sec-landscape}. This appendix starts with 
a brief description of the VASP software package, as well as its input and 
output files (Sec.~\ref{appendix:sec-files}) and most important input 
parameters (Sec.~\ref{appendix:sec-input}). Next, the chapter details the 
settings used to obtain all of the results presented in this thesis, organised 
per chapter and section in the order they are presented. Finally, there are 
still two brief sections, one on parallelization tests 
(Sec.~\ref{appendix:sec-parallel}) and one on an issue with the way 
VASP calculates the real part of the dielectric tensor using 
the \dft{Kramers-Kronig}{} relation.

\section{Vienna Ab initio Simulation Package} \label{appendix:sec-VASP} 
 
In order to solve the many-body problem using DFT, we need a software package 
that is able to implement the theory numerically on a computer cluster. 
Currently, there is a wide selection of such packages available to 
computational scientists, each with their respective advantages and 
disadvantages. 
 
VASP is particularly suited for materials science, relying on an unbiased
\dft{plane wave basis}{} set and offering several \dft{PAW}{} datasets for 
most atomic species of the periodic table. It can calculate an approximate 
solution to the many-body Schr\"odinger equation within the DFT formalism or 
the HF approximation, including the possibility of mixing to utilize hybrid 
functionals. VASP also employs a set of efficient iterative procedures to find 
the ground state of a system, and allows parallelization of the calculations 
on multi-core machines. 
 
This section presents a concise overview of the different files used by 
VASP, discussing their purpose, and takes a closer look at the 
input parameters and their relation to the theory. 
 
\subsection{Files} \label{appendix:sec-files}
 
VASP uses four basic input files for its calculations, which 
must always be in the directory where it is executed:
 
\begin{itemize} 
 
\phantomsection \label{appendix:sec-INCAR} 
\item \href{https://www.vasp.at/wiki/index.php/INCAR}{\texttt{INCAR}}: 
Contains the input parameters for the calculation. Various settings can be 
adjusted according to the needs of the user through a large number of 
\textit{tags}, which are described in Section~\ref{appendix:sec-input}. This 
can be considered the most important input file, in the sense that it has 
the most diverse content and therefore has a lot of control over the 
calculation. Because of this, it is also more prone to be the cause of errors. 
 
\phantomsection \label{appendix:sec-POSCAR} 
\item \href{https://www.vasp.at/wiki/index.php/POSCAR}{\texttt{POSCAR}}: 
Contains the lattice vectors of the unit cell, as well as the atomic positions 
of the structure. The user is free to specify the atomic positions in cartesian 
or direct coordinates. In case selective dynamics is used to fix certain atom 
coordinates in the unit cell, this is also indicated in this file. In order to 
make sure there are no mistakes in the POSCAR file, it is important to first 
visualize the structure. 
 
\phantomsection \label{appendix:sec-KPOINTS} 
\item \href{https://www.vasp.at/wiki/index.php/KPOINTS}{\texttt{KPOINTS}}: 
Defines the $\mathbf{k}$ point mesh (Sec.~\ref{dft:sec-kpoints}), either by 
explicitly entering all the points or using an automatically generated 
\dft{MP}{} grid. For band structure calculations, there is the useful 
\textit{line mode}. Here the user can specify certain (symmetry) lines along 
which to calculate the band structure of the crystal. These lines are described 
pairwise via the coordinates of their end points.
 
\phantomsection \label{appendix:sec-POTCAR} 
\item \href{https://www.vasp.at/wiki/index.php/POTCAR}{\texttt{POTCAR}}: 
Concatenation of the \dft{PAW}{} 
datasets for the different elements present in the crystal structure. VASP 
supplies a set of POTCAR files for each element and supported functional, 
corresponding to different choices for the number of valence electrons and 
radii of the PAW sphere. It is important to make sure the order of the atoms 
is the same for the POTCAR and POSCAR file. 

\end{itemize}

Besides these four essential files, a few other files can serve as input files 
for the VASP calculation:

\begin{itemize}

\phantomsection \label{appendix:sec-STOPCAR} 
\item \href{https://www.vasp.at/wiki/index.php/STOPCAR}{\texttt{STOPCAR}}:
This file can be used to stop the calculation without killing the VASP 
process. By writing either \texttt{LABORT = True} or \texttt{LSTOP = True} to 
the \texttt{STOPCAR} file, the user can stop the calculation after the next 
electronic or ionic step, respectively.

\phantomsection \label{appendix:sec-CHGCAR} 
\item \href{https://www.vasp.at/wiki/index.php/CHGCAR}{\texttt{CHGCAR}}: 
The electronic charge density of the unit cell is written to this file. 
Although the file is an output file, it can be used as an input file to 
start a calculation with a desired charge density.

\phantomsection \label{appendix:sec-WAVECAR} 
\item \href{https://www.vasp.at/wiki/index.php/WAVECAR}{\texttt{WAVECAR}}: 
The plane wave coefficients of the wave functions are written to this file. 
Although the file is an output file, it can be used as an input file to 
start a calculation with a desired set of wave functions. Note that this 
is only possible if neither the number of bands nor the set of plane waves 
has changed.

\end{itemize} 

During the calculation, VASP produces a set of output files from which the 
user can extract the data necessary for his or her research. Here I present a  
(non-exhaustive) list of the most important VASP output files, besides the 
\vasp{CHGCAR} and \vasp{WAVECAR} already presented previously.
 
\begin{itemize} 
 
\phantomsection \label{appendix:sec-OUTCAR} 
\item \href{https://www.vasp.at/wiki/index.php/OUTCAR}{\texttt{OUTCAR}}: 
The general output file of VASP, a lot of information is printed in the this 
file during the calculation. The verbosity of the output is determined by the 
\href{https://www.vasp.at/wiki/index.php/NWRITE}{\texttt{NWRITE}} tag in the 
\vasp{INCAR} file. 

\phantomsection \label{appendix:sec-OSZICAR} 
\item \href{https://www.vasp.at/wiki/index.php/OSZICAR}{\texttt{OSZICAR}}: 
Presents an overview of the total energy at each SCF iteration, as well 
as some other properties interesting for monitoring the convergence of the 
calculation, for each ionic step in the case a geometry optimization is performed.

\phantomsection \label{appendix:sec-CONTCAR} 
\item \href{https://www.vasp.at/wiki/index.php/CONTCAR}{\texttt{CONTCAR}}: 
The final lattice vectors and atom positions of the unit cells are witten to 
this file. Obviously this is mostly important when performing a geometric 
optimization.

\phantomsection \label{appendix:sec-vasprun} 
\item \texttt{vasprun.xml}: 
XML formatted output file, written at the end of the calculation. A lot of 
output from other files is gathered into this one file, which makes it the 
most useful for post processing.

\phantomsection \label{appendix:sec-DOSCAR} 
\item \href{https://www.vasp.at/wiki/index.php/DOSCAR}{\texttt{DOSCAR}}:
Contains the density of states (DOS) of the system, as well as the integrated DOS 
and the projected DOS, in case \href{https://www.vasp.at/wiki/index.php/LORBIT}{\texttt{LORBIT}} is set correctly.

\phantomsection \label{appendix:sec-IBZKPT} 
\item \href{https://www.vasp.at/wiki/index.php/IBZKPT}{\texttt{IBZKPT}}: 
The set of irreducible $\mathbf{k}$-points, along with their respective 
weights, can be found in this file.

\phantomsection \label{appendix:sec-EIGENVAL} 
\item \href{https://www.vasp.at/wiki/index.php/EIGENVAL}{\texttt{EIGENVAL}}: 
Details the Kohn-Sham eigenvalues for all $\mathbf{k}$-points, which can 
for example be used to plot the band structure. 

\end{itemize} 

Note that some output is present in several files, but unfortunately 
VASP is not always entirely sensible in which output is printed where. 
An example here is the fact that although the \texttt{vasprun.xml} file 
contains \link{dft:sec-dielectric}{the dielectric tensor}, it does not 
contain \link{dft:sec-drude}{the plasma frequencies}. 
 
\subsection{Input Parameters} \label{appendix:sec-input} 
 
This section presents some of the input tags which are set by 
the user to determine the specifics of the calculation. The list below is by 
no means exhaustive; we simply focus on a selection of tags that were 
especially relevant for the results presented in this thesis. For the complete 
list, we refer the reader to the 
\href{https://www.vasp.at/wiki/index.php/The_VASP_Manual}{VASP manual}. 
 
\begin{itemize} 
 
\phantomsection \label{appendix:sec-ENCUT} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/ENCUT}{\texttt{ENCUT}}: 
Energy cutoff (in \si{\electronvolt}) used for determining the size of the 
\link{dft:sec-basis_set}{plane wave basis set}, as per 
Eq.~(\ref{dft:eq-energy_cutoff}).
 
\phantomsection \label{appendix:sec-PREC} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/PREC}{\texttt{PREC}}: 
Determines several settings that influence the precision of the calculations. 
First, the default value of the energy cutoff is increased for higher precision 
settings. Second, \texttt{PREC} sets the density of the grid used for the 
Fourier transformation. Finally, the precision of the representation of the 
\link{dft:sec-PAW}{PAW} projectors is set by PREC.
 
\phantomsection \label{appendix:sec-ALGO} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/ALGO}{\texttt{ALGO}}: 
Sets the algorithm used for the diagonalization of the Hamiltonian matrix 
when solving the \link{dft:sec-kohn_sham}{Kohn-Sham equations}.

\phantomsection \label{appendix:sec-EDIFF} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/EDIFF}{\texttt{EDIFF}}: 
Convergence criterion on the \link{dft:fig-scf_cycle}{self-consistency cycle} 
during the electronic optimization, i.e. when determining the electron charge 
density.
 
\phantomsection \label{appendix:sec-ISMEAR} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/ISMEAR}{\texttt{ISMEAR}}: 
Specifies the \textit{smearing} method. Smearing is a technique that is designed 
to improve the convergence of calculation with respect to the sampling of the 
first Brillouin zone, specifically for metals. An excellent discussion by Prof. 
Marzari on the topic can be found 
\href{http://theossrv1.epfl.ch/Main/ElectronicTemperature}{here}. The basic idea 
is to replace the step function in the calculation of the total energy: 
\begin{equation}\label{appendix:eq-intsmear} 
\sum_n \frac{1}{\Omega_{BZ}}\int_{BZ} \epsilon_{n\mathbf{k}} 
\Theta(\epsilon_{n\mathbf{k}} - E_F) d\mathbf{k}, 
\end{equation} 
by a smooth function $f(\{\epsilon_{n\mathbf{k}}\})$. The main advantage of 
using smearing methods is that the integral in Eq.~(\ref{appendix:eq-intsmear}) can be 
calculated accurately using a relatively sparse $\mathbf{k}$-mesh 
(Sec.~\ref{dft:sec-kpoints}). Another method used to solve the integral in 
Eq.~(\ref{appendix:eq-intsmear}) is the \textit{tetrahedron} method~\cite{Blochl1994a} 
(ISMEAR = -5), which linearly interpolates $\epsilon_{n\mathbf{k}}$ between 
each p \textbf{k}-points. Which method is preferable depends on the calculation 
being performed, and is specified by the input set loaded by the 
\link{automation:sec-WriteVaspFromIOSet}{WriteVaspFromIOSet} task.
 
\phantomsection \label{appendix:sec-SIGMA} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/SIGMA}{\texttt{SIGMA}}: 
Smearing width used for the smearing of the occupies, as per the method 
specified with \texttt{ISMEAR}. Note that specifying \texttt{SIGMA} for 
the tetrahedron method makes little sense, as this method does not apply any 
smearing.

\phantomsection \label{appendix:sec-IBRION} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/ISIF}{\texttt{IBRION}}: 
Determines the algorithm for the geometry optimization. A common and stable 
choice here is the conjugate gradient algorithm~\cite{Press2007} (\texttt{IBRION} = 2). 

\phantomsection \label{appendix:sec-ISIF} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/ISIF}{\texttt{ISIF}}: 
Specifies the degrees of freedom for the geometry optimization, e.g. whether to 
optimize only the atomic positions (\texttt{ISIF = 2}), or perform a full 
optimization of the structure (\texttt{ISIF = 3}).

\phantomsection \label{appendix:sec-EDIFFG} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/EDIFFG}{\texttt{EDIFFG}}: 
Sets the value for the convergence condition of the geometry optimization. The 
condition can be either applied to the total energy by setting a positive value, 
or the forces, when a negative value is provided.
 
\phantomsection \label{appendix:sec-LOPTICS} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/LOPTICS}{\texttt{LOPTICS}}: 
Boolean setting that indicates that the 
\link{dft:sec-dielectric}{frequency dependent dielectric tensor} should be 
calculated.

\phantomsection \label{appendix:sec-CSHIFT} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/CSHIFT}{\texttt{CSHIFT}}: 
Complex shift used in the \dft{Kramers-Kronig}{} relation used to calculate 
the real part of the dielectric tensor. We refer the reader to 
Appendix~\ref{appendix:sec-cshift} for more details.

\phantomsection \label{appendix:sec-NBANDS} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/NBANDS}{\texttt{NBANDS}}: 
Number of bands to include in the calculation. VASP includes a limited 
number of empty bands by default, but in order to calculate the optical properties 
or density of states over a larger energy range, this number should be increased 
to at least 2-3 times the default value.

\phantomsection \label{appendix:sec-NEDOS} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/NEDOS}{\texttt{NEDOS}}: 
Number of points in the energy mesh for the calculation of the density of states 
and dielectric tensor.
 
\phantomsection \label{appendix:sec-ISPIN} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/ISPIN}{\texttt{ISPIN}}: 
Specifies the spin-polarization setting, i.e. 1 or 2. The default is to perform 
a non-spin-polarized calculation (\texttt{ISPIN} = 1). Using \texttt{ISPIN} = 2 
starts a spin-polarized calculation, i.e. for a system with collinear spins.
 
\phantomsection \label{appendix:sec-MAGMOM} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/MAGMOM}{\texttt{MAGMOM}}: 
Allows the user to set the magnetic moments of all the atoms in the unit cell, 
when performing a spin-polarized calculation with collinear spins (\texttt{ISPIN} = 1).
For non-collinear calculations, the magnetization density is a vectorial quantity, 
and the components of the magnetiziation density should be provided for each atom, 
with respect to the spin quantization axis (see 
\href{https://cms.mpi.univie.ac.at/wiki/index.php/SAXIS}{SAXIS}).

\phantomsection \label{appendix:sec-LHFCALC} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/LHFCALC}{\texttt{LHFCALC}}: 
Boolean tag that indicates that the \link{dft:sec-hybrid}{Hartree-Fock/DFT hybrid 
calculations} should be performed. 

\phantomsection \label{appendix:sec-AEXX} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/AEXX}{\texttt{AEXX}}: 
Determines the mixing parameter for the \link{dft:sec-hybrid}{hybrid calculations}, 
i.e. the fraction $a$ of Hartree-Fock exact exchange energy that should be 
included for the short range interaction.

\phantomsection \label{appendix:sec-HFSCREEN} 
\item \href{https://cms.mpi.univie.ac.at/wiki/index.php/HFSCREEN}{\texttt{HFSCREEN}}: 
Specifies the separation parameter $\omega$ for 
\link{dft:sec-hybrid}{hybrid calculations}, i.e. beyond what distance the 
interaction energy is considered to be long range instead of short range.

\end{itemize} 

\pagebreak[4]
\section{Results} \label{appendix:sec-results} 

This section provides a more conventional description of the computational 
settings used for the calculations. Most of these have been directly copied 
from the corresponding papers, and updated slightly where necessary. As these 
sections are supposed to serve as a reference which each header of sections 
that discuss results links to, there is quite a bit of repetition if the reader 
goes through this section in one go.

\subsection{Solar Cells} \label{appendix:sec-solar} 

\subsubsection{Structure and formation energy} \label{appendix:sec-solar_structure} 
 
\begin{wraptable}[13]{r}{0.4\textwidth} \vspace{-2.5em}
\centering 
\renewcommand{\arraystretch}{1.2} 
\captionsetup{width=0.36\textwidth}
\caption{Electron configuration of the atoms.} 
\label{appendix:tab-valElec}
\begin{tabular}{c@{\hskip 1 em}l}\hline 
Element & Configuration \\\hline 
Cu & [Ar] \underline{3d$^{10}$4s$^1$} \\ 
Ag & [Kr] \underline{4d$^{10}$5s$^1$} \\ 
Ga & [Ar] 3d$^{10}$\underline{4s$^2$4p$^1$}\\ 
In & [Kr] 4d$^{10}$\underline{5s$^{2}$4p$^1$} \\ 
S  & [Ne] \underline{3s$^2$3p$^4$} \\ 
Se & [Ar] 3d$^{10}$\underline{4s$^{2}$4p$^4$} \\ 
Te & [Kr] 4d$^{10}$\underline{5s$^2$5p$^4$}\\ 
\hline 
\end{tabular} 
\end{wraptable} 
We make a selection of ten compounds for which we can compare the calculated 
efficiency of the CuAu-like (CA) phase with the chalcopyrite (CH) results of 
Yu and Zunger~\cite{Yu2012}. The CA and CH structure are studied using a 
first-principles approach within the \dft{DFT}{} formalism, as implemented in 
the \dft{VASP}{}. The \dft{PAW}{} method is applied, and the electrons that 
are treated as valence electrons are underlined in 
Table~\ref{appendix:tab-valElec}. The exchange-correlation functional is 
calculated using the \dft{GGA}{} of \dft{PBE}{}. The energy cutoff for the 
\dft{plane wave basis}{} is set to 350~\si{\electronvolt}, and a 
4$\times$4$\times$4 \dft{MP}{} mesh is used for sampling the first Brillouin 
zone. The charge density is considered converged when the energy difference 
between two electronic steps is smaller than $10^{-4}$~\si{\electronvolt}. 
The geometry is considered optimized when the forces on the atoms are all 
below $10^{-2}$~\si{\electronvolt}/\si{\angstrom}.

\phantomsection \label{appendix:sec-solar_efficiency}
\subsubsection{Absorber layer efficiency} 

Because an accurate band gap is important for the correct evaluation of the 
efficiency, we perform single shot G$_0$W$_0$~\cite{Hedin1965} 
calculations on top of hybrid \dft{HSE06}{}. However, in order to  
update the quasiparticle energies within the G$_0$W$_0$ approximation with 
sufficient precision, it is necessary to consider the semi-core electrons 
as valence electrons within the PAW framework~\cite{Fuchs2007}. Hence, 
we treat the 3$s$, 3$p$ and 3$d$ (4$s$, 4$p$ and 4$d$) orbitals as 
valence states for the Ga (In) atoms for the G$_0$W$_0$@HSE06 calculations 
of the band gap, on top of those underlined in 
Table~\ref{appendix:tab-valElec}. In addition, we use a well converged 
8$\times$8$\times$8 \dft{MP}{}, an energy cutoff of 400~\si{\electronvolt} 
and a large amount of unoccupied bands (600 in total). 
 
The optical properties are calculated within the Random Phase Approximation 
(RPA), using the long wavelength expression for the imaginary part of the 
\dft{dielectric tensor}{}. The real part of the dielectric 
tensor is determined using the \dft{Kramers-Kronig}{} relation\footnote{The 
Kramers-Kronig relation is calculated by VASP using a complex shift 
(``\vasp{CSHIFT}''). After calculating the real part, however, VASP also 
recalculates the corresponding imaginary part. Since the complex shift 
introduces a broadening, this causes an earlier onset of the imaginary part, 
and consequently in the absorption coefficient. In order to prevent this, we 
commented out the line in the VASP code that recalculates the imaginary 
part. Note that in a more recent version of VASP, this smearing of the 
imaginary part can also be avoided by choosing a smaller CSHIFT settings. 
See Appendix~\ref{appendix:sec-cshift}.}. In order to get an accurate 
description of the energy levels, the 
exchange-correlation energy is calculated with the \dft{HSE06}{} functional, 
which has been reported~\cite{Wan2013} to produce optical properties close 
to those obtained from experiment for \ce{CuIn(S_xSe_{x-1})2}. We find that 
it is sufficient to sample the Brillouin zone using a 12$\times$12$\times$12 
\dft{MP}{} mesh to obtain a reasonably converged dielectric tensor. The number 
of unoccupied bands is increased to at least three times the number of 
occupied bands. Because of the tetragonal symmetry of the CA structure, the 
resulting dielectric tensor is 
diagonal and has two independent components $\varepsilon_{xx}$ 
(=$\varepsilon_{yy}$) and $\varepsilon_{zz}$. Since we make no assumptions 
about the direction from which the photons enter the absorber layer, we 
average the diagonal components to derive the dielectric function $\varepsilon 
(E) = \varepsilon^{(1)} (E) + i \varepsilon^{(2)} (E) $ at energy $E$. 
Finally, in order to obtain a more accurate onset of the absorption spectrum, 
we shift the imaginary part of the dielectric function to the G$_0$W$_0$@HSE06 
band gap, and recalculate the real part using the 
\link{dft:eq-kramers}{Kramers-Kronig relations}.  
 
\subsection{Li-ion Batteries} 

All calculations are performed based on the \dft{DFT}{} formalism, as 
implemented in the \dft{VASP}{}. The \dft{PAW}{} is used to make a 
distinction between the core and valence electrons, with the standard 
\href{https://cms.mpi.univie.ac.at/vasp/vasp/Recommended_PAW_potentials_DFT_calculations_using_vasp_5_2.html}{VASP recommended choice} for the 
number of valence electrons. The wave functions of the valence electrons are 
expanded in a \dft{plane wave basis}{} set, using a high energy cutoff equal to 
500~\si{\electronvolt}, which is advisable for structures containing oxygen. 

\subsubsection{Structure and Li-configurations} \label{appendix:sec-structure} 

The configurations are optimized with \dft{PBEU}, where a range of choices 
for the U parameter were tested to closely match the magnetic moments and 
lattice constants of a \dft{HSE06}{} calculation for bulk O3-\ce{Li2MnO3} using 
the same settings as described below. We settled on a U correction of 
3.9~\si{\electronvolt}, applied to the 3$d$ orbitals of \ce{Mn}. A \dft{MP}{}
mesh with a reciprocal density of 100~\si{\per\angstrom\cubed} is chosen for the 
k-point sampling of the Brillouin zone. Geometry optimizations were performed 
with a Gaussian smearing of 0.05~\si{\electronvolt}, followed by a static 
calculation using the tetrahedron method~\cite{Blochl1994a} for a more precise 
calculation of the total energy, where we have doubled the density of the 
k-point mesh. The energy convergence criterion on the 
electronic optimization is set at $10^{-5}$~\si{\electronvolt}, and 
$10^{-3}$~\si{\electronvolt} for the geometric optimization, i.e. the 
difference in energy between ionic steps. For the static calculation, the 
electronic energy convergence criterion is tightened slightly to 
$10^{-6}$~\si{\electronvolt}. All lowest energy bulk structures are 
further optimized with the \dft{HSE06}{} functional to obtain the final 
geometries discussed in the text. 

\phantomsection \label{appendix:sec-oxidation} 
\subsubsection{Oxidation}

All calculations of the magnetic moments and density of states were performed 
with the hybrid \dft{HSE06}{} functional, based on the geometries obtained from 
the calculations presented in the previous section. The density of the
\dft{MP}{} mesh was doubled to 200~\si{\per\angstrom\cubed}, and the 
tetrahedron method~\cite{Blochl1994a} was used for the integration of the 
Brillouin zone. As \ce{Ir} is known to exhibit a strong spin-orbit interaction, 
non-collinear calculations including spin-orbit coupling were performed for 
calculating the magnetic moment and density of states of \ce{Li_xIrO3}. The 
charge density is considered converged when the difference in energy between 
electronic steps is smaller than $10^{-5}$~\si{\electronvolt}.
 
\phantomsection \label{appendix:sec-dimer} 
\subsubsection{Dimer} 

The dimer reaction energy and kinetics of both compounds were calculated in a 
2$\times$2$\times$2 supercell, where we once again switched to the \dft{PBEU}{} 
functional in order to make the dimer screening computationally feasible. 
We applied a U correction of 3.9~\si{\electronvolt} to the 3$d$ orbitals of 
\ce{Mn}. For \ce{Ir}, we used the same value as McCalla et al.~\cite{McCalla2015} 
(4.0~\si{\electronvolt}). Activation energies were calculated using the 
\dft{NEB}{} method. 

\phantomsection \label{appendix:sec-sn_stability}
\subsubsection{Thermodynamic Stability of Sn substitution}  

The formation energies of Sn-substituted structures for a range of x-values have been calculated within the \dft{DFT}{} framework, as implemented in the \dft{VASP}{}. The \dft{PAW}{} method was used to make a distinction between the core and valence electrons, with the \href{https://cms.mpi.univie.ac.at/vasp/vasp/Recommended_PAW_potentials_DFT_calculations_using_vasp_5_2.html}{standard VASP recommended choice} for the number of valence electrons. The exchange-correlation energy was calculated using the SCAN+rVV10~\cite{Sun2015, Peng2016} functional to include the van der Waals interaction, which is especially important for a layered structure such as \ce{SnO}~\cite{Govaerts2013}. The wave functions of the valence electrons are expanded in a \dft{plane wave basis}{} set, using a high energy cutoff equal to 500~\si{\electronvolt}, which is advisable for structures containing oxygen. For all 2$\times$2$\times$2 supercell calculations, a 3$\times$3$\times$3 \dft{MP}{} mesh was used for sampling the Brillouin zone, whereas a 6$\times$6$\times$3 and 9$\times$9$\times$7 mesh were used for \ce{Li2SnO3} and \ce{SnO}, respectively. Geometry optimizations were performed with a Gaussian smearing of 0.05~\si{\electronvolt}, followed by a static calculation using the tetrahedron method~\cite{Blochl1994a}, for a precise calculation of the total energies. The convergence criterion on the electronic optimization is set at $10^{-4}$~\si{\electronvolt}, and $10^{-3}$~\si{\electronvolt} for the geometric optimization. 

\phantomsection \label{appendix:sec-substitutions} 
\subsubsection{Influence of \ce{Mn^{4+}} substitution on oxygen stability} 

For the calculation of the density of states and kinetic barrier of the dimer formation, both the \dft{PBEU}{} and SCAN~\cite{Sun2015} functionals have been used. Similar to our previous calculations, we have applied a U correction of 3.9~\si{\electronvolt} to the 3$d$ orbitals of \ce{Mn}. For \ce{V} and \ce{Mo}, we have applied a U correction of 3.1~\si{\electronvolt}~\cite{Richards2017} and 4.38~\si{\electronvolt}~\cite{MP_Li2MoO3}, respectively. A 3$\times$3$\times$3 \dft{MP}{} mesh was used for sampling the Brillouin zone for all geometry optimizations, including those of the \dft{NEB}{} calculations with the climbing image modification~\cite{Henkelman2000a} used to calculate the kinetic barrier. A more dense 7$\times$7$\times$9 mesh was used for the calculation of the density of states. For the calculation of the kinetic barrier, the FIRE~\cite{Bitzek2006} force-based optimizer was used, and the convergence condition on the forces was set at 10$^{-2}$~\si{\electronvolt\per\angstrom}.

\phantomsection \label{appendix:sec-landscape}
\subsubsection{Energy landscape of \ce{[CB11H12]^{-}}}

All calculations for the landscapes were performed within the \dft{DFT}{} framework, as implemented in the \href{http://www.nwchem-sw.org/index.php/Main_Page}{NWChem software package}~\cite{Valiev2010}. All atoms adopted correlation consistent \link{dft:sec-gaussian}{local basis sets} at the double zeta level with diffuse augmentation (aug-cc-pVDZ)~\cite{Dunning1989, Kendall1992, Prascher2010}, as provided by the EMSL basis set exchange~\cite{Feller1996, Schuchardt2007}. The exchange-correlation energy was calculated using the \dft{GGA}{} of \dft{PBE}{}. Each point in the energy landscapes \ce{LiCB11H12} and \ce{NaCB11H12} molecules were computed using a static calculation of the energy of the isolated cation-anion system.

\subsection{Ion-Induced Secondary Electron Emission} \label{appendix:sec-quotas} 
 
\subsubsection{Semiconductors} \label{appendix:sec-semiconductors} 

Hagstrum's model requires the density of states of the valence 
$D_v(\varepsilon)$ and conduction $D_c(\varepsilon)$ band as input, as well as 
the vacuum level. We calculate the density of states and vacuum level of 
\ce{Ge(111)} and \ce{Si(111)} using a \dft{DFT}{} approach, as implemented in 
the \dft{VASP}{}. Within the \dft{PAW}{} formalism, the recommended number of 
valence electrons is included for both \ce{Ge} and \ce{Si}. The energy cutoff 
is set at 500~\si{\electronvolt} in order to obtain a well converged 
\dft{plane wave basis}{} set, and the exchange correlation energy is calculated 
using the \dft{GGA}{} approximation of \dft{PBE}{}. A well converged 
18$\times$36$\times$1 \dft{MP}{} k-point mesh is used for sampling the 
Brillouin zone.
  
To simulate a surface within the periodic boundary framework of VASP, it is 
conventional to take a slab approach, where a certain number of atomic layers 
are separated by a suitably large vacuum layer 
(See~\ref{automation:sec-surface}). For \ce{Si} and \ce{Ge}, it is 
well known that the (111) surfaces reconstruct, forming dimers at the surface 
with a 2$\times$1 periodicity. We take the reconstructed structures from the 
supplementary material of De Waele et al.~\cite{DeWaele2016} and subsequently 
optimize the geometry using the computational parameters described in the 
previous paragraph. The slab consists of 14 atomic layers and at least 20 
\si{\angstrom} of vacuum spacing is present. The vacuum level is obtained by 
averaging the one-electron electrostatic potential over planes parallel to the 
surface and determining the potential in the vacuum, which should be constant 
in case the vacuum layer is sufficiently thick. The work function $\phi$ of 
the surface is then calculated by comparing the vacuum level with the top of 
the valence band $\phi = \varepsilon_0 - \varepsilon_v$.

\subsubsection{Metals} \phantomsection \label{appendix:sec-metals} 

Hagstrum's model requires the density of states of the occupied and unoccupied 
($D_v(\varepsilon)$ and $D_c(\varepsilon)$) states as input, as well as 
the vacuum level. We calculate the density of states and vacuum level of 
all metal surfaces using a \dft{DFT}{} approach, as implemented in the 
\dft{VASP}{}. Within the \dft{PAW}{} formalism, the recommended number of valence 
electrons is included for all metals. The energy cutoff is set at 
500~\si{\electronvolt} in order to obtain a well converged \dft{plane wave basis}{} 
set, and the exchange correlation energy is calculated using the \dft{GGA}{} 
of \dft{PBE}{}. For sampling the Brillouin zone, \dft{MP}{} k-point mesh is used 
for which the spacing in each direction is smaller than 0.05~\si{\per\angstrom}.

To simulate a surface within the periodic boundary framework of VASP, it is 
conventional to take a slab approach, where a certain number of atomic layers 
are separated by a suitably large vacuum layer (See~\ref{automation:sec-surface}).
We take the structures of all surfaces from the 
supplementary material of De Waele et al.~\cite{DeWaele2016} and subsequently 
optimize the geometry using the computational parameters described in the 
previous paragraph. The slab consists of 14 atomic layers and at least 20 
\si{\angstrom} of vacuum spacing is present. The vacuum level is obtained by 
averaging the one-electron electrostatic potential over planes parallel to the 
surface and determining the potential in the vacuum, which should be constant 
in case the vacuum layer is sufficiently thick. The work function $\phi$ of 
the surface is then calculated by comparing the vacuum level with the top of 
the valence band $\phi = \varepsilon_0 - \varepsilon_v$. 

The optical properties of the bulk are calculated within the Random Phase 
Approximation (RPA), using the long wavelength expression for the imaginary 
part of the \dft{dielectric tensor}{}. The real part of the dielectric tensor is 
determined using the \link{dft:eq-kramers}{Kramers-Kronig} relations. For the damping parameter in 
the Drude expression of the \link{dft:sec-drude}{intraband part of the 
dielectric tensor} a value of 50~\si{\milli\electronvolt} is used.

\pagebreak[4]
\resultsection{Parallelization \label{appendix:sec-parallel}}{https://mybinder.org/v2/gh/mbercx/jupyter/master?filepath=parallel\%2Fparallel_analysis.ipynb} 

In order to speed up the calculations of the workflows, it is important to set 
reasonably good parallelization parameters for VASP 
(\texttt{NPAR}/\texttt{NCORE}, \texttt{KPAR}). Knowing beforehand what settings 
are optimal is tricky, as this depends on the system being studied, the 
computational settings and the machine the calculations are being run on. To 
come up with the somewhat rudimentary algorithm behind 
\link{automation:sec-VaspParallelizationTask}{\texttt{VaspParallelizationTask}},
I have performed a whole series of tests on a selected set of systems. An 
illustration of the (partial) results of such a test can be seen in 
Figure~\ref{appendix:fig-parallelization}. The square with a thick red edge indicates the setting 
which was found by
\link{automation:sec-VaspParallelizationTask}{\texttt{VaspParallelizationTask}}. 
The algorithm doesn't always find the optimal setting, but does a fairly good 
job of finding one that does not waste significant amount of resources compared 
to the optimal choice. Clearly, it does a much better job compared to the default
(\texttt{KPAR} = \texttt{NPAR} = 1). All other parallelization tests can be 
explored interactively via \href{https://mybinder.org/v2/gh/mbercx/jupyter/master?filepath=parallel\%2Fparallel_analysis.ipynb}{the jupyter notebook corresponding 
to this section.}

\begin{figure}[ht]
\centering
\href{https://www.youtube.com/watch?v=q8rcTvAoRzk}{
\includegraphics[width=\textwidth]{\figurepath/appendix/parallelization.png}
}
\caption{Example of a parallelization test for \ce{U3O8}. The number in each 
square represents the average electronic time step.}
\label{appendix:fig-parallelization}
\end{figure}
 
\pagebreak[4]
\resultsection{\texttt{CSHIFT} \label{appendix:sec-cshift}}{https://github.com/mbercx/phd-thesis/blob/master/jupyter/appendix/onset_analysis.ipynb} 

In order to calculate the real part of the dielectric tensor, VASP 
uses the Kramers-Kronig transformation (Eq.~(\ref{dft:eq-kramers})):
\begin{equation}
\varepsilon_{\alpha \beta}^{(1)} (\omega) = 1 + \frac{2}{\pi} \mathcal{P} 
\int_0^\infty \frac{\varepsilon_{\alpha \beta}^{(2)} 
(\omega')\omega'}{(\omega')^2 - \omega^2}d\omega'.
\end{equation} 
However, this complex integral has a pole at the origin. This is solved by 
relying on a small complex shift, i.e. the whole integration path is shifted 
slightly into the complex plane:
\begin{equation}
\varepsilon_{\alpha \beta}^{(1)} (\omega) = 1 + \frac{2}{\pi} 
\int_0^\infty \frac{\varepsilon_{\alpha \beta}^{(2)} 
(\omega')\omega'}{(\omega')^2 - \omega^2 + i\eta}d\omega', 
\end{equation} 
where $\eta$ is the complex shift, which can be set in the \vasp{INCAR} 
file using the  \vasp{CSHIFT} tag. Relying on a complex shift introduces 
a slight broadening to the real part of the dielectric tensor. So far, 
this does not affect the optical properties such as the absorption 
coefficient significantly. However, VASP also calculates 
the corresponding broadened imaginary part. This leads to an earlier onset of 
the imaginary part of the dielectric tensor, and subsequently an earlier onset 
of the absorption coefficient and absorptivity. Effectively, the band gap of 
the material is fictitiously reduced, which has a large effect on the 
efficiency calculated in Chapter~\ref{chapter:slme}.

One way of mitigate this issue is by removing all absorption below the 
band gap, i.e. setting the absorptivity $\alpha(E)$ to zero for $E < E_g$. 
This is definitely an improvement, but still can have quite a significant 
influence on the efficiency. Fortunately, VASP overwrites the 
broadened imaginary part of the dielectric tensor by the original calculated 
using Eq.~(\ref{dft:eq-imdiel}) under certain conditions (which are 
unfortunately not usually obtained using the default settings).  More 
specifically, in case the complex shift (\vasp{CSHIFT}) is smaller than 
the distance between two points in the energy mesh, VASP will 
output the original - unbroadened - imaginary part of the dielectric tensor.

\pgfplotsset{every axis/.style={scale=0.95, font=\sffamily,
legend style={font=\footnotesize\sffamily, 
fill opacity=0.8, text opacity=1}}} 
\begin{wrapfigure}{r}{0.52\textwidth}
\vspace{-2em}
\centering
\input{\figurepath/appendix/onset.tex}
\caption{Difference in onset of the absorptivity for the settings described in 
the text.}
\label{appendix:fig-onset}
\end{wrapfigure}

To understand the influence of these various effects, I have set up a 
notebook studying the onset of the absorptivity at 500~\si{\nano\meter}
for low and high \vasp{CSHIFT} value, based on the dielectric function of 
CA-\ce{CuInS2}. Figure~\ref{appendix:fig-onset} summarizes the results for 
the absorptivity. The broadening of the absorptivity for the (default) high 
\vasp{CSHIFT} value is clear. Due to the severely reduced effective band 
gap, the calculated efficiency for the broadened absorptivity is 10 times 
smaller than the unbroadened value. We can also that that when the absorptivity 
is cut below the band gap, there is still a large difference in the onset 
when compared to the unbroadened (low \vasp{CSHIFT}) case. The difference in 
efficiency is about 2~\%.

\chapter{Plasmonic Excitations} \label{appendix:sec-plasmons} 

\section{Poisson Processes} \label{sec:appendix-poisson} 

A Poisson process is defined as (taken from~\cite{MITopencourseware}):

\begin{adjustwidth}{1em}{0em} 
\textit{A Poisson process is a renewal process in which the interarrival 
intervals $T_p$ follow an exponential distribution function; i.e., for some 
real $\lambda_p > 0$, $T_p$ has the probability density function}
\begin{equation}
f_{T_p} (t) = 
\begin{cases} 
\lambda_p e^{-\lambda_p t} &\text{  for } t \geq 0 \\ 
0 &\text{  for } t < 0
\end{cases}
\end{equation}
\end{adjustwidth} 
Let's start with some basic expressions that facilitate the derivations of the 
plasmon probabilities. First, note that the probability density function is 
properly normalized to 1:
\begin{eqnarray*}
\int_{-\infty}^\infty \lambda_p e^{-\lambda_p t} dt &=& \int_0^\infty \lambda_p e^{-\lambda_p t} dt \\
                     &=& \lambda_p \left[ \frac{1}{-\lambda_p} e^{-\lambda_p t} \right]_0^\infty \\
                     &=& -(0 - 1) = 1.
\end{eqnarray*}
The probability of the interval of process $p$ being smaller than some 
specified interval $T$ is:
\begin{eqnarray}
\text{Pr}\{T_p \leq T\} &=& \int_0^T \lambda_p e^{-\lambda_p t} dt \nonumber \\
                     &=& \lambda_p \left[ \frac{1}{-\lambda_p} e^{-\lambda_p t} \right]_0^T \nonumber \\
                     &=& -(e^{-\lambda_p T} - 1) = 1 - e^{-\lambda_p T},
\end{eqnarray}
which is simply the cumulative distribution function of the Poisson process. 
Similarly, the probability of the interval being larger than some 
specified interval $T$ is:
\begin{eqnarray}
\text{Pr}\{T_p > T\} &=& 1 - \text{Pr}\{T_p \leq T\} \nonumber \\
                     &=& 1 - (1 - e^{-\lambda_p T}) = e^{-\lambda_p T}
\end{eqnarray}
For two competing Poisson processes with rates $\lambda_1$ and 
$\lambda_2$, the probability of the interval $T_1$ being smaller than $T_2$ is:
\begin{eqnarray} 
\text{Pr}\{T_1 < T_2\} &=& \int_0^\infty \text{Pr}\{T_1 < T_2 | T_1 = t \} \lambda_1 e^{-\lambda_1 t} dt \nonumber \\
                       &=& \int_0^\infty \text{Pr}\{T_2 > t\} \lambda_1 e^{-\lambda_1 t} dt \nonumber \\
                       &=& \int_0^\infty e^{-\lambda_2 t} \lambda_1 e^{-\lambda_1 t} dt \nonumber \\
                       &=& \lambda_1 \int_0^\infty e^{- (\lambda_1 + \lambda_2) t} dt \nonumber \\
                       &=& \frac{\lambda_1}{-(\lambda_1 + \lambda_2)} (0 - 1) \nonumber \\
                       &=& \frac{\lambda_1}{\lambda_1 + \lambda_2} \label{appendix:eq-competing}
\end{eqnarray} 

Equation~(\ref{quotas:eq-sp_poisson}) is now fairly easy to derive. Consider two 
Poisson processes, one for the surface plasmon excitation ($sp$) and one for
the Auger neutralization ($aug$):
\begin{eqnarray*} 
f_{T_{sp}}(E_{sp}, t) &=& \lambda_{sp} (E_{sp}) e^{-\lambda_{sp}(E_{sp}) t}\\ 
f_{T_{aug}}(t) &=& \lambda_{aug} e^{-\lambda_{aug} t}.
\end{eqnarray*}
The probability of a surface plasmon excitation is equal to that of the 
interval $T_{sp}$ being smaller than $T_{aug}$:
\begin{eqnarray} 
P_{sp}(E_{sp}) &=& \text{Pr}\{T_{sp} < T_{aug}\} \nonumber \\
               &\stackrel{(\ref{appendix:eq-competing})}{=}& \frac{\lambda_{sp} (E_{sp}) }{\lambda_{sp} (E_{sp})  + \lambda_{aug}} \\
\end{eqnarray} 

For the volume plasmons, we have to consider multiple competing Poisson processes. 
First, note that two independent Poisson processes with rates $\lambda_1$ and 
$\lambda_2$ can be merged into a new Poisson process with rate $\lambda' = \lambda_1 
+ \lambda_2$. So, if we consider a third process with rate $\lambda_3$, the probability 
of the interval of this process being smaller than that of process $1$ and $2$ is:
\begin{eqnarray} 
\text{Pr}\{T_3 < T'\} &=& \frac{\lambda_3 }{\lambda' + \lambda_3} \nonumber \\
                      &=& \frac{\lambda_3 }{\lambda_1  + \lambda_2 + \lambda_3}.
\end{eqnarray} 
By extension, the probability of a Poisson process with rate $\lambda_n$ having 
the shortest interval among a set of independent processes $\{\lambda_i\}$, with 
$i = 1, ..., N$, becomes:
\begin{equation}
\text{Pr}\{T_n < \text{min}(T_1, T_2, ..., T_{n-1}, T_{n+1}, ..., T_N)\} = \frac{\lambda_n}{\lambda_1  + ... + \lambda_N}.
\end{equation}
Within our model, an electron with energy $\varepsilon$ can excite plasmons up to 
energy $\varepsilon - \varepsilon_F$, and the rate of exciting a volume plasmon with 
energy $E_{vp}$ is proportional to the energy loss function $L(E)$:
\begin{equation} 
\lambda_{vp}(E_{vp}) = 
\begin{cases} 
c_{vp} \cdot L(E_{vp}) &\text{  for } 0 < E_{vp} \leq \varepsilon - \varepsilon_F \\
0 &\text{  for } E_{vp} \leq 0 \text{ or } E_{vp} > \varepsilon - \varepsilon_F.
\end{cases}
\end{equation} 
In this case, we have a continuous set of independent Poisson processes, each with 
rate equal to $\lambda_{vp}(E_{vp})$, so the probability distribution of first
exciting a volume plasmon with energy $E_{vp}$ becomes:
\begin{equation}
P_{vp}(\varepsilon, E_{vp}) = \text{Pr}\{T_{vp}(E_{vp}) = \text{min}(T_{vp}(E)\} = \frac{\lambda_{vp}(E_{vp})}{\int_0^{\varepsilon - \varepsilon_F} \lambda_{vp}(E) dE}.
\end{equation}
Note that this distribution is properly normalized to 1:
\begin{eqnarray*}
\int_0^\infty P_{vp}(\varepsilon, E_{vp}) dE_{vp} &=& \int_0^\infty P_{vp}(\varepsilon, E_{vp}) dE_{vp}  \\
&=& \frac{\int_0^\infty \lambda_{vp}(E_{vp}) dE_{vp}}{\int_0^{\varepsilon - \varepsilon_F} \lambda_{vp}(E) dE} \\
&=& \frac{c_{vp} \int_0^{\varepsilon - \varepsilon_F} L(E_{vp}) dE_{vp}}{c_{vp} \int_0^{\varepsilon - \varepsilon_F} L(E) dE} = 1 \\
\end{eqnarray*}
However, we also have to consider the average travel interval of the electrons 
$t_e$. As the total rate of the volume plasmon excitation process is 
$\int_0^{\varepsilon - \varepsilon_F} \lambda_{vp}(E) dE$, the probability of 
any volume plasmon being excited in the interval $t_e$ is:
\begin{equation}
\text{Pr}\{\text{min}(T_{vp}(E)) < t_e \} = 1 - e^{-(\int_0^{\varepsilon - \varepsilon_F} \lambda_{vp}(E) dE) t_e}.
\end{equation}
Combining both leads to the probability distribution of a volume plasmon 
excitation for an electron with average travel interval $t_e$:
\begin{eqnarray}
P_{vp}(\varepsilon, E_{vp}) dE_{vp} &=& \frac{\lambda_{vp}(E_{vp})dE_{vp}}{\int_0^{\varepsilon - \varepsilon_F} \lambda_{vp}(E) dE }\left[1-e^{-\left(\int_0^{\varepsilon - \varepsilon_F} \lambda_{vp}(E_{vp}) dE\right) t_e }\right] \nonumber \\
&=& \frac{c_{vp} L(E_{vp})dE_{vp}}{\int_0^{\varepsilon - \varepsilon_F} c_{vp} L(E) dE }\left[1-e^{-\left(\int_0^{\varepsilon - \varepsilon_F} c_{vp} L(E) dE\right) t_e }\right] \nonumber \\
&=& \frac{L(E_{vp})dE_{vp}}{\int_0^{\varepsilon - \varepsilon_F} L(E) dE 
}\left[1-e^{-\left(\int_0^{\varepsilon - \varepsilon_F} L(E) dE\right) c_{vp} t_e 
}\right] \label{appendix:eq-vp_prob}
\end{eqnarray}
 
\section{Volume Plasmons} 
 
Consider the distribution of excited electrons $N_i(\varepsilon)$. The 
probability that an excited electron at energy $\varepsilon$ induces a volume 
plasmon of energy $E_{vp} < \varepsilon - \varepsilon_F$ is given by Eq.~(\ref{appendix:eq-vp_prob}). The fraction of electrons which excite a volume plasmon is then equal to: 
\begin{equation} 
    N_{vp}^{-}(\varepsilon) = \int_0^\infty N_i(\varepsilon) 
P_{vp}(\varepsilon, E_{vp}) dE_{vp}. 
\end{equation} 
These are substracted from the excited electron density. However, these 
electrons are not lost, they have simply lost an energy equal to the volume 
plasmon energy $E_{vp}$. Hence, we have to add the following density to the 
excited density again: 
\begin{equation} 
    N_{vp}^{+}(\varepsilon) = \int_0^\infty N_i(\varepsilon + E_{vp}) 
P_{vp}(\varepsilon, E_{vp}) dE_{vp}. 
\end{equation} 
The story doesn't end there, however. Volume plasmons do not couple with 
transversal waves~\cite{Maier2007}, and hence cannot decay radiatively. Most likely, the 
plasmon will decay as a single electron excitation. In order to model this, we 
first calculate the distribution of plasmons with an energy $E_{vp}$: 
\begin{equation} 
    D_{vp} (E_{vp})= \int_0^\infty N_i(\varepsilon) P_{vp}(\varepsilon, 
E_{vp}) d\varepsilon 
\end{equation} 
When these plasmons decay, they release an energy equal to $E_vp$. In other 
words, this distribution should be convoluted with the density of the occupied 
states $D_v(\varepsilon)$ in order to obtain the density of excited electrons 
due to volume plasmon decay: 
\begin{eqnarray} 
    N_{vp}^{d}(\varepsilon) &=& \frac{1}{n_{vp}}(D_v * D_{vp}) (\varepsilon) 
\\ 
    &=& \frac{1}{n_{vp}} \int_{\Delta\varepsilon_v} D_v(\varepsilon_1) 
D_{vp}(\varepsilon - \varepsilon_1) d\varepsilon_1 \\ 
    &=& \frac{1}{n_{vp}} \int_{\Delta\varepsilon_v} D_v(\varepsilon_1)  
    \int_0^\infty N_i(\varepsilon_2) P_{vp}(\varepsilon_2, \varepsilon - 
\varepsilon_1) d\varepsilon_2 d\varepsilon_1  
\end{eqnarray} 
where $n_{vp}$ is a normalization factor. Of course, this distribution should 
be normalized to the number of excited plasmons, i.e.: 
\begin{equation} 
    n_{vp} = \int_0^\infty N_{vp}^{-}(\varepsilon) d\varepsilon 
\end{equation} 

\section{Surface Plasmons} 
 
Hagstrum's Auger transform can be written as a convolution: 
\begin{equation} 
\begin{aligned} 
T\left[\frac{\varepsilon + \varepsilon_0 - E_i}{2}\right] &= 
\int_{\Delta\varepsilon_v}\int_{\Delta\varepsilon_v} D_v (\varepsilon_1) D_v 
(\varepsilon_2) \delta(\varepsilon - \varepsilon_1 - \varepsilon_2 + 
\varepsilon_0 - E_i) d\varepsilon_1 d\varepsilon_2. \\ 
&= \int_{\Delta\varepsilon_v} D_v (\varepsilon_1) D_v (\varepsilon + 
\varepsilon_0 - E_i - \varepsilon_1) d\varepsilon_1 \\  
&= (D_v * D_v) (\varepsilon + \varepsilon_0 - E_i) 
\end{aligned} 
\end{equation} 
which can also be written as: 
\begin{equation} 
T\left[\frac{\varepsilon + \varepsilon_0 - E_i}{2}\right] = D_v(\varepsilon) * 
D_v(\varepsilon + \varepsilon_0 - E_i) 
\end{equation} 
 
Here, $D_E(\varepsilon) = D_v(\varepsilon + \varepsilon_0 - E_i)$ 
corresponds to the distribution of energies released by the neutralization of 
the incoming ion\footnote{This should be more clear when we substitute e.g. 
$\varepsilon = 0$ in $D_E(\varepsilon)$. We then obtain $D_v(\varepsilon_0 - 
E_i)$, i.e. the number of electrons in the valence band that are at an equal 
depth (in relation to the vacuum level) as the lowest unoccupied state of the 
incoming ion. Clearly, electrons at this level do not pass energy through any 
Auger process, as this is a resonant neutralization. Another way of 
understanding this is that an electron at energy level $\varepsilon_0 - E_i + 
\varepsilon$ releases an energy of $\varepsilon$ when it neutralizes the 
incoming ion.}.  In order to include surface plasmon excitations, we consider 
the probability that a plasmon with energy $E_{sp}$ is excited instead of an 
Auger process: 
\begin{equation}
P_{sp}(E_{sp}) = \frac{ \frac{c_{sp}}{\lambda_{aug}} 
\text{Im}\left[-\frac{1}{\epsilon(E_{sp}) + 1}\right]}{\frac{c_{sp}}{\lambda_{aug}} 
\text{Im}\left[-\frac{1}{\epsilon(E_{sp}) + 1}\right] + 1} 
\end{equation} 
As the surface plasmon excitation process is considered to be resonant, 
$E_{sp}$ must correspond to the energy released in the neutralization of the 
incoming ion, i.e. $\varepsilon$ in $D_E(\varepsilon)$. The leftover 
distribution of energies passed to other valence electrons through an Auger 
process is: 
\begin{equation} 
    D_{aug}(\varepsilon) = D_E(\varepsilon) (1 - P_{sp}(\varepsilon)) 
\end{equation} 
We substitute this distribution in the expression for the Auger transform: 
\begin{equation} 
\begin{aligned} 
T'\left[\frac{\varepsilon + \varepsilon_0 - E_i}{2}\right] &= D_v(\varepsilon) 
* D_{aug}(\varepsilon) \\ &= D_v(\varepsilon) * (D_v(\varepsilon + 
\varepsilon_0 - E_i) (1 - P_{sp}(\varepsilon))) 
\end{aligned} 
\end{equation} 
And use this Auger transform instead of the original one in the nominator of 
Eq.~(\ref{quotas:eq-excite}). Note that the normalization in the denominator 
of Eq.~(\ref{quotas:eq-excite}) should still use the original Auger transform,
else the number of excited electrons due to the neutralization are 
still normalized to one per incoming ion. 

\printbibliography 
\end{refsection} 
